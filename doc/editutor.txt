*editutor.txt*  ai-editutor - Learn to code better with AI guidance

==============================================================================
CONTENTS                                                    *editutor-contents*

    1. Introduction .......................... |editutor-introduction|
    2. Requirements .......................... |editutor-requirements|
    3. Installation .......................... |editutor-installation|
    4. Configuration ......................... |editutor-configuration|
    5. Usage ................................. |editutor-usage|
    6. Skip Answered Questions ............... |editutor-skip-answered|
    7. Visual Selection ...................... |editutor-visual|
    8. Incremental Hints ..................... |editutor-hints|
    9. Knowledge Tracking .................... |editutor-knowledge|
   10. LSP Context ........................... |editutor-lsp-context|
   11. Conversation Memory ................... |editutor-conversation|
   12. Commands .............................. |editutor-commands|
   13. Keymaps ............................... |editutor-keymaps|
   14. API ................................... |editutor-api|
   15. Health Check .......................... |editutor-health|

==============================================================================
1. INTRODUCTION                                         *editutor-introduction*

ai-editutor is a Neovim plugin that acts as your personal coding mentor. Unlike
code generation tools like GitHub Copilot, ai-editutor explains concepts and
guides your learning instead of writing code for you.

Philosophy: "Teach a person to fish, don't fish for them."

v1.0.0 - Simplified Q: Only Mode:
  - ONE prefix to rule them all: just use Q: and express your intent naturally
  - Skip answered questions: Q: with A: below are automatically skipped
  - Visual selection support: select code, write Q:, get focused explanation
  - Removed S/R/D/E modes - just use Q: with natural language

Examples: >
    // Q: What is closure?                    -> explains concept
    // Q: Review this function                -> gives code review
    // Q: Debug: why does this return nil?    -> guides debugging
    // Q: Explain using Socratic method       -> asks guiding questions
<

Features:
  - Simplified Q: syntax (express intent naturally)
  - Skip answered questions (Q: with A: below)
  - Visual selection support
  - 5-level progressive hints
  - BM25 search via SQLite FTS5
  - Multi-signal context ranking
  - Knowledge tracking (save and search Q&A history)
  - LSP-based context (auto-fetches related definitions)
  - Conversation memory (follow-up questions keep context)
  - Multiple LLM providers (Claude, OpenAI, DeepSeek, Groq, Ollama, etc.)
  - Multi-language support (English, Vietnamese)

==============================================================================
2. REQUIREMENTS                                         *editutor-requirements*

Required:
  - Neovim 0.9.0+
  - plenary.nvim (for HTTP requests)
  - An API key for Claude/OpenAI (or local Ollama)

Recommended:
  - LSP server for your language (for enhanced context extraction)
  - nvim-treesitter (for AST-based code chunking)
  - sqlite.lua (for BM25 search and knowledge persistence)

==============================================================================
3. INSTALLATION                                         *editutor-installation*

Using lazy.nvim: >lua
    {
      "your-username/editutor",
      dependencies = {
        "nvim-lua/plenary.nvim",
        "nvim-treesitter/nvim-treesitter",  -- Recommended
        "kkharji/sqlite.lua",               -- Recommended
      },
      config = function()
        require("editutor").setup({
          provider = "claude",
        })
      end,
    }
<

==============================================================================
4. CONFIGURATION                                       *editutor-configuration*

Default configuration: >lua
    require("editutor").setup({
      -- LLM Provider
      -- Options: claude, openai, deepseek, groq, together, openrouter, ollama
      provider = "claude",
      model = "claude-sonnet-4-20250514",

      -- Behavior
      language = "English",  -- or "Vietnamese"

      -- LSP Context extraction
      context = {
        lines_around_cursor = 100,
        external_context_lines = 30,
        max_external_symbols = 20,
      },

      -- Indexer Settings
      indexer = {
        context_budget = 4000,
        debounce_ms = 1000,
      },

      -- Keymaps (works in normal and visual mode)
      keymaps = {
        ask = "<leader>ma",
      },
    })
<

==============================================================================
5. USAGE                                                       *editutor-usage*

Basic Usage:

1. Write a comment with Q: prefix: >
    // Q: What is the time complexity of this algorithm?
<

2. Press <leader>ma (or your configured keymap)

3. The explanation is inserted as a comment below: >
    // Q: What is the time complexity of this algorithm?
    /*
    A: This algorithm has O(n) time complexity because...
    */
<

Express Your Intent Naturally:                               *editutor-intents*

The unified prompt adapts to your question: >
    // Q: What is closure?                  -> explains concept
    // Q: Review this function              -> gives code review
    // Q: Debug: why does this return nil?  -> guides debugging
    // Q: How can I improve this?           -> suggests improvements
    // Q: Explain using Socratic method     -> asks guiding questions
<

Comment Style Detection:                                *editutor-comment-style*

ai-editutor automatically uses the appropriate comment style:
  - JS/TS/Go/Rust/C: /* block comment */
  - Python: """ docstring """
  - Lua/SQL: --[[ block ]]
  - HTML/XML: <!-- comment -->
  - Shell/YAML: # line comment

==============================================================================
6. SKIP ANSWERED QUESTIONS                             *editutor-skip-answered*

Questions that already have A: responses below are automatically skipped.
This prevents re-asking questions that have already been answered.

Example: >
    function test() {
      // Q: What is closure?       <- SKIPPED (has A: below)
      /*
      A: A closure is a function...
      */

      // Q: How does async work?   <- FOUND (unanswered)
      return 42;
    }
<

How It Works:
  - Parser checks next 5 lines after Q: for A: patterns
  - Supported A: formats:
    - Block comments: /* A: ... */ or --[[ A: ... ]]
    - Line comments: // A: ... or # A: ...
  - If A: found, skips to find next unanswered Q:

Use |include_answered| parameter to override: >lua
    parser.find_query(bufnr, line, true)  -- includes answered questions
<

==============================================================================
7. VISUAL SELECTION                                          *editutor-visual*

Select code and ask focused questions about it.

Usage:
  1. Enter visual mode (v or V)
  2. Select the code block you want to focus on
  3. Include a // Q: comment within the selection
  4. Press <leader>ma

The selected code is sent with "FOCUS ON THIS" priority in the prompt,
with surrounding code as secondary context.

Example: >
    function calculate(a, b) {    <- Select from here
      const result = a + b;
      // Q: Explain this function <- Include Q: in selection
      return result * 2;
    }                             <- To here
<

Press <leader>ma in visual mode, and the AI will focus on explaining
the selected code block.

==============================================================================
8. INCREMENTAL HINTS                                          *editutor-hints*

The hints system provides progressive assistance in 5 levels:

  Level 1: Conceptual - What concepts are relevant?
  Level 2: Strategic - What approach to consider?
  Level 3: Directional - Where in the code to look?
  Level 4: Specific - What techniques to try?
  Level 5: Solution - Complete answer with explanation

Usage:
  1. Write your question: // Q: How do I fix this bug?
  2. Run :EduTutorHint (gets Level 1)
  3. Run :EduTutorHint again (gets Level 2)
  4. Keep running for more detailed hints

Each hint level replaces the previous response in your code.

==============================================================================
9. KNOWLEDGE TRACKING                                      *editutor-knowledge*

ai-editutor automatically saves all Q&A pairs for future reference.

Commands:
  :EduTutorHistory     Show recent Q&A history
  :EduTutorSearch      Search knowledge base
  :EduTutorExport      Export to markdown file
  :EduTutorStats       Show statistics

Storage:
  - SQLite (if sqlite.lua is installed)
  - JSON fallback (~/.local/share/nvim/editutor_knowledge.json)

==============================================================================
10. LSP CONTEXT                                          *editutor-lsp-context*

ai-editutor automatically gathers context from your project using LSP.

When you ask a question, it:
  1. Extracts code around your cursor
  2. Finds identifiers using Tree-sitter
  3. Uses LSP go-to-definition to find where they're defined
  4. Includes relevant definitions from other project files
  5. Filters out library code

==============================================================================
11. CONVERSATION MEMORY                                 *editutor-conversation*

ai-editutor remembers your conversation for follow-up questions.

Session Rules:
  - Same file + within 50 lines = continues session
  - Different file = starts new session
  - More than 30 min = starts new session

Commands:
  :EduTutorConversation       Show session info
  :EduTutorClearConversation  Clear session

==============================================================================
12. COMMANDS                                                *editutor-commands*

Core Commands:
  :EduTutorAsk            Ask about current Q: comment
  :EduTutorHint           Ask with progressive hints

Knowledge Commands:
  :EduTutorHistory        Show Q&A history
  :EduTutorSearch [query] Search knowledge base
  :EduTutorExport [path]  Export to markdown
  :EduTutorStats          Show statistics

Indexer Commands:
  :EduTutorIndex          Index project for BM25 search
  :EduTutorIndex!         Force re-index
  :EduTutorIndexStats     Show indexer statistics
  :EduTutorClearCache     Clear context cache

Language Commands:
  :EduTutorLang           Show/set language
  :EduTutorLang English   English responses
  :EduTutorLang Vietnamese Vietnamese responses

Conversation Commands:
  :EduTutorConversation       Show session info
  :EduTutorClearConversation  Clear session

Health:
  :checkhealth editutor   Check plugin health

==============================================================================
13. KEYMAPS                                                  *editutor-keymaps*

Default keymaps (configurable):

  Normal mode:
    <leader>ma    Ask about Q: at cursor

  Visual mode:
    <leader>ma    Ask about selected code (with Q: in selection)

==============================================================================
14. API                                                          *editutor-api*

Main API: >lua
    local editutor = require("editutor")

    editutor.setup(opts)
    editutor.ask()              -- Normal mode ask
    editutor.ask_visual()       -- Visual mode ask
    editutor.ask_with_hints()   -- Progressive hints
    editutor.version()          -- Returns "1.0.0"
<

Parser API: >lua
    local parser = require("editutor.parser")

    parser.parse_line(line)           -- Returns question or nil
    parser.has_answer_below(lines, line_num)  -- Check for A: below
    parser.find_query(bufnr, line, include_answered)
    parser.find_query_in_range(bufnr, start_line, end_line)
    parser.get_visual_selection()     -- Get selection info
    parser.find_all_queries(bufnr, include_answered)
<

Prompts API: >lua
    local prompts = require("editutor.prompts")

    prompts.get_system_prompt()
    prompts.build_user_prompt(question, context, _, selected_code)
    prompts.get_hint_prompt(level)
    prompts.get_language()
<

Comment Writer API: >lua
    local comment_writer = require("editutor.comment_writer")

    comment_writer.get_style(bufnr)
    comment_writer.format_response(response, bufnr, line)
    comment_writer.insert_or_replace(response, question_line, bufnr)
<

Knowledge API: >lua
    local knowledge = require("editutor.knowledge")

    knowledge.save({ mode, question, answer, language, filepath })
    knowledge.search(query, limit)
    knowledge.get_recent(limit)
    knowledge.get_stats()
    knowledge.export_markdown(filepath)
<

Provider API: >lua
    local provider = require("editutor.provider")

    provider.query_async(system, user, callback)
    provider.query_stream(system, user, on_chunk, on_done, opts)
    provider.register_provider(name, config)
    provider.list_providers()
<

==============================================================================
15. HEALTH CHECK                                              *editutor-health*

Run health check to verify setup: >
    :checkhealth editutor
<

This checks:
  - Neovim version
  - Required dependencies
  - Provider configuration
  - Database status
  - Cache status

==============================================================================
vim:tw=78:ts=8:ft=help:norl:
